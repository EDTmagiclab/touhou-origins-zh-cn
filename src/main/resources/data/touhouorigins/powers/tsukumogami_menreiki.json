{
  "type": "apoli:multiple",
  "item_ownership": {
    "type": "origins:action_on_callback",
    "entity_action_gained": {
      "type": "apoli:execute_command",
      "command": "give @s observer{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_kitsune_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1} 1"
    },
    "entity_action_lost": {
      "type": "apoli:and",
      "actions": [
        {
          "type": "apoli:execute_command",
          "command": "clear @s observer{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_kitsune_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
        },
        {
          "type": "apoli:execute_command",
          "command": "clear @s dropper{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_fuku_no_kami_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
        },
        {
          "type": "apoli:execute_command",
          "command": "clear @s dispenser{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_uba_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
        }
      ]
    },
    "entity_action_respawned": {
      "type": "apoli:and",
      "actions": [
        {
          "type": "apoli:execute_command",
          "command": "clear @s observer{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_kitsune_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
        },
        {
          "type": "apoli:execute_command",
          "command": "clear @s dropper{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_fuku_no_kami_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
        },
        {
          "type": "apoli:execute_command",
          "command": "clear @s dispenser{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_uba_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
        },
        {
          "type": "apoli:execute_command",
          "command": "give @s observer{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_kitsune_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1} 1"
        }
      ]
    }
  },
  "clear_on_death": {
    "type": "apoli:action_when_damage_taken",
    "entity_action": {
      "type": "apoli:and",
      "actions": [
        {
          "type": "apoli:change_resource",
          "resource": "*:*_resource",
          "change": 0,
          "operation": "set"
        },
        {
          "type": "apoli:execute_command",
          "command": "kill @e[type=item,sort=nearest,nbt={Item:{id:\"minecraft:observer\",tag:{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_kitsune_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}}}]"
        },
        {
          "type": "apoli:execute_command",
          "command": "kill @e[type=item,sort=nearest,nbt={Item:{id:\"minecraft:dropper\",tag:{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_fuku_no_kami_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}}}]"
        },
        {
          "type": "apoli:execute_command",
          "command": "kill @e[type=item,sort=nearest,nbt={Item:{id:\"minecraft:dispenser\",tag:{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_uba_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}}}]"
        }
      ]
    },
    "condition": {
      "type": "apoli:health",
      "comparison": "<=",
      "compare_to": 0
    },
    "cooldown": 1
  },
  "resource": {
    "type": "apoli:resource",
    "min": 0,
    "max": 2
  },
  "cycle_masks_forward": {
    "type": "apoli:active_self",
    "cooldown": 1,
    "entity_action": {
      "type": "apoli:if_else",
      "condition": {
        "type": "apoli:resource",
        "resource": "*:*_resource",
        "comparison": "==",
        "compare_to": 2
      },
      "if_action": {
        "type": "apoli:change_resource",
        "resource": "*:*_resource",
        "change": 0,
        "operation": "set"
      },
      "else_action": {
        "type": "apoli:change_resource",
        "resource": "*:*_resource",
        "change": 1
      }
    },
    "condition": {
      "type": "apoli:equipped_item",
      "equipment_slot": "head",
      "item_condition": {
        "type": "apoli:nbt",
        "nbt": "{tsukumogami_bound:1}"
      }
    }
  },
  "cycle_masks_backward": {
    "type": "apoli:active_self",
    "cooldown": 1,
    "key": {
      "key": "key.origins.secondary_active"
    },
    "entity_action": {
      "type": "apoli:if_else",
      "condition": {
        "type": "apoli:resource",
        "resource": "*:*_resource",
        "comparison": "==",
        "compare_to": 0
      },
      "if_action": {
        "type": "apoli:change_resource",
        "resource": "*:*_resource",
        "change": 2,
        "operation": "set"
      },
      "else_action": {
        "type": "apoli:change_resource",
        "resource": "*:*_resource",
        "change":-1
      }
    },
    "condition": {
      "type": "apoli:equipped_item",
      "equipment_slot": "head",
      "item_condition": {
        "type": "apoli:nbt",
        "nbt": "{tsukumogami_bound:1}"
      }
    }
  },
  "set_masks_forward": {
    "type": "apoli:active_self",
    "entity_action": {
      "type": "apoli:if_else_list",
      "actions": [
        {
          "condition": {
            "type": "apoli:and",
            "conditions": [
              {
                "type": "apoli:resource",
                "resource": "*:*_resource",
                "comparison": "==",
                "compare_to": 0
              },
              {
                "type": "apoli:equipped_item",
                "equipment_slot": "head",
                "item_condition": {
                  "type": "apoli:nbt",
                  "nbt": "{tsukumogami_bound:1}"
                }
              }
            ]
          },
          "action": {
            "type": "apoli:and",
            "actions": [
              {
                "type": "apoli:execute_command",
                "command": "item replace entity @s armor.head with observer{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_kitsune_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
              },
              {
                "type": "apoli:execute_command",
                "command": "title @s actionbar {\"translate\":\"power.touhouorigins.menreiki_kitsune\",\"color\":\"gold\",\"bold\":true,\"italic\":true}"
              },
              {
                "type": "apoli:play_sound",
                "sound": "touhouorigins:entity.menreiki.swap"
              }
            ]
          }
        },
        {
          "condition": {
            "type": "apoli:and",
            "conditions": [
              {
                "type": "apoli:resource",
                "resource": "*:*_resource",
                "comparison": "==",
                "compare_to": 1
              },
              {
                "type": "apoli:equipped_item",
                "equipment_slot": "head",
                "item_condition": {
                  "type": "apoli:nbt",
                  "nbt": "{tsukumogami_bound:1}"
                }
              }
            ]
          },
          "action": {
            "type": "apoli:and",
            "actions": [
              {
                "type": "apoli:execute_command",
                "command": "item replace entity @s armor.head with dropper{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_fuku_no_kami_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
              },
              {
                "type": "apoli:execute_command",
                "command": "title @s actionbar {\"translate\":\"power.touhouorigins.menreiki_fuku_no_kami\",\"color\":\"dark_green\",\"bold\":true,\"italic\":true}"
              },
              {
                "type": "apoli:play_sound",
                "sound": "touhouorigins:entity.menreiki.swap"
              }
            ]
          }
        },
        {
          "condition": {
            "type": "apoli:and",
            "conditions": [
              {
                "type": "apoli:resource",
                "resource": "*:*_resource",
                "comparison": "==",
                "compare_to": 2
              },
              {
                "type": "apoli:equipped_item",
                "equipment_slot": "head",
                "item_condition": {
                  "type": "apoli:nbt",
                  "nbt": "{tsukumogami_bound:1}"
                }
              }
            ]
          },
          "action": {
            "type": "apoli:and",
            "actions": [
              {
                "type": "apoli:execute_command",
                "command": "item replace entity @s armor.head with dispenser{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_uba_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
              },
              {
                "type": "apoli:execute_command",
                "command": "title @s actionbar {\"translate\":\"power.touhouorigins.menreiki_uba\",\"color\":\"dark_aqua\",\"bold\":true,\"italic\":true}"
              },
              {
                "type": "apoli:play_sound",
                "sound": "touhouorigins:entity.menreiki.swap"
              }
            ]
          }
        }
      ]
    },
    "cooldown": 1
  },
  "set_masks_backward": {
    "type": "apoli:active_self",
    "key": {
      "key": "key.origins.secondary_active"
    },
    "entity_action": {
      "type": "apoli:if_else_list",
      "actions": [
        {
          "condition": {
            "type": "apoli:and",
            "conditions": [
              {
                "type": "apoli:resource",
                "resource": "*:*_resource",
                "comparison": "==",
                "compare_to": 0
              },
              {
                "type": "apoli:equipped_item",
                "equipment_slot": "head",
                "item_condition": {
                  "type": "apoli:nbt",
                  "nbt": "{tsukumogami_bound:1}"
                }
              }
            ]
          },
          "action": {
            "type": "apoli:and",
            "actions": [
              {
                "type": "apoli:execute_command",
                "command": "item replace entity @s armor.head with observer{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_kitsune_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
              },
              {
                "type": "apoli:execute_command",
                "command": "title @s actionbar {\"translate\":\"power.touhouorigins.menreiki_kitsune\",\"color\":\"gold\",\"bold\":true,\"italic\":true}"
              },
              {
                "type": "apoli:play_sound",
                "sound": "touhouorigins:entity.menreiki.swap"
              }
            ]
          }
        },
        {
          "condition": {
            "type": "apoli:and",
            "conditions": [
              {
                "type": "apoli:resource",
                "resource": "*:*_resource",
                "comparison": "==",
                "compare_to": 1
              },
              {
                "type": "apoli:equipped_item",
                "equipment_slot": "head",
                "item_condition": {
                  "type": "apoli:nbt",
                  "nbt": "{tsukumogami_bound:1}"
                }
              }
            ]
          },
          "action": {
            "type": "apoli:and",
            "actions": [
              {
                "type": "apoli:execute_command",
                "command": "item replace entity @s armor.head with dropper{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_fuku_no_kami_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
              },
              {
                "type": "apoli:execute_command",
                "command": "title @s actionbar {\"translate\":\"power.touhouorigins.menreiki_fuku_no_kami\",\"color\":\"dark_green\",\"bold\":true,\"italic\":true}"
              },
              {
                "type": "apoli:play_sound",
                "sound": "touhouorigins:entity.menreiki.swap"
              }
            ]
          }
        },
        {
          "condition": {
            "type": "apoli:and",
            "conditions": [
              {
                "type": "apoli:resource",
                "resource": "*:*_resource",
                "comparison": "==",
                "compare_to": 2
              },
              {
                "type": "apoli:equipped_item",
                "equipment_slot": "head",
                "item_condition": {
                  "type": "apoli:nbt",
                  "nbt": "{tsukumogami_bound:1}"
                }
              }
            ]
          },
          "action": {
            "type": "apoli:and",
            "actions": [
              {
                "type": "apoli:execute_command",
                "command": "item replace entity @s armor.head with dispenser{display:{Name:'{\"translate\":\"item.touhouorigins.tsukumogami_menreiki_uba_name\"}',Lore:['{\"translate\":\"item.touhouorigins.tsukumogami_bound_one\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_two\"}','{\"translate\":\"item.touhouorigins.tsukumogami_bound_three\"}']},tsukumogami_bound:1,head_slottable:1}"
              },
              {
                "type": "apoli:execute_command",
                "command": "title @s actionbar {\"translate\":\"power.touhouorigins.menreiki_uba\",\"color\":\"dark_aqua\",\"bold\":true,\"italic\":true}"
              },
              {
                "type": "apoli:play_sound",
                "sound": "touhouorigins:entity.menreiki.swap"
              }
            ]
          }
        }
      ]
    },
    "cooldown": 1
  },
  "kitsune_give_glowing": {
    "type": "apoli:action_over_time",
    "condition": {
      "type": "apoli:and",
      "conditions": [
        {
          "type": "apoli:equipped_item",
          "equipment_slot": "head",
          "item_condition": {
            "type": "apoli:nbt",
            "nbt": "{tsukumogami_bound:1}"
          }
        },
        {
          "type": "apoli:equipped_item",
          "equipment_slot": "head",
          "item_condition": {
            "type": "apoli:ingredient",
            "ingredient": {
              "item": "minecraft:observer"
            }
          }
        }
      ]
    },
    "entity_action": {
      "type": "apoli:raycast",
      "distance": 256,
      "fluid_handling": "none",
      "bientity_condition": {
        "type": "apoli:target_condition",
        "condition": {
          "type": "apoli:living"
        }
      },
      "bientity_action": {
        "type": "apoli:target_action",
        "action": {
          "type": "apoli:and",
          "actions": [
            {
              "type": "apoli:grant_power",
              "power": "touhouorigins:is_glowing",
              "source": "touhouorigins:tsukumogami_menreiki"
            },
            {
              "type": "apoli:trigger_cooldown",
              "power": "touhouorigins:is_glowing_cooldown"
            },
            {
              "type": "apoli:change_resource",
              "resource": "touhouorigins:is_glowing_cooldown",
              "change": 12000
            }
          ]
        }
      }
    },
    "interval": 1
  },
  "kitsune_sees_glowing": {
    "type": "apoli:entity_glow",
    "use_teams": false,
    "red": 1,
    "green": 0.1,
    "blue": 0.1,
    "entity_condition": {
      "type": "apoli:and",
      "conditions": [
        {
          "type": "apoli:living"
        },
        {
          "type": "apoli:power",
          "power": "touhouorigins:is_glowing"
        }
      ]
    },
    "bientity_condition": {
      "type": "apoli:actor_condition",
      "condition": {
        "type": "apoli:and",
        "conditions": [
          {
            "type": "apoli:equipped_item",
            "equipment_slot": "head",
            "item_condition": {
              "type": "apoli:nbt",
              "nbt": "{tsukumogami_bound:1}"
            }
          },
          {
            "type": "apoli:equipped_item",
            "equipment_slot": "head",
            "item_condition": {
              "type": "apoli:ingredient",
              "ingredient": {
                "item": "minecraft:observer"
              }
            }
          }
        ]
      }
    }
  },
  "revoke_glowing_on_mask_swap": {
    "type": "apoli:action_over_time",
    "rising_action": {
      "type": "apoli:area_of_effect",
      "radius": 256,
      "bientity_action": {
        "type": "apoli:target_action",
        "action": {
          "type": "apoli:revoke_power",
          "power": "touhouorigins:is_glowing",
          "source": "touhouorigins:tsukumogami_menreiki"
        }
      }
    },
    "condition": {
      "type": "apoli:and",
      "conditions": [
        {
          "type": "apoli:equipped_item",
          "equipment_slot": "head",
          "item_condition": {
            "type": "apoli:nbt",
            "nbt": "{tsukumogami_bound:1}"
          }
        },
        {
          "type": "apoli:equipped_item",
          "equipment_slot": "head",
          "item_condition": {
            "type": "apoli:ingredient",
            "ingredient": [
              {
                "item": "minecraft:dropper"
              },
              {
                "item": "minecraft:dispenser"
              }
            ]
          }
        }
      ]
    }
  },
  "fuku_no_kami_power_up": {
    "type": "apoli:modify_status_effect_duration",
    "status_effects": [
      "minecraft:speed",
      "minecraft:haste",
      "minecraft:strength",
      "minecraft:instant_health",
      "minecraft:jump_boost",
      "minecraft:regeneration",
      "minecraft:resistance",
      "minecraft:fire_resistance",
      "minecraft:water_breathing",
      "minecraft:invisibility",
      "minecraft:night_vision",
      "minecraft:health_boost",
      "minecraft:absorption",
      "minecraft:saturation",
      "minecraft:luck",
      "minecraft:slow_falling",
      "minecraft:conduit_power",
      "minecraft:dolphins_grace",
      "minecraft:hero_of_the_village"
    ],
    "modifier": {
      "operation": "multiply_base_multiplicative",
      "value": 0.20
    },
    "condition": {
      "type": "apoli:and",
      "conditions": [
        {
          "type": "apoli:equipped_item",
          "equipment_slot": "head",
          "item_condition": {
            "type": "apoli:nbt",
            "nbt": "{tsukumogami_bound:1}"
          }
        },
        {
          "type": "apoli:equipped_item",
          "equipment_slot": "head",
          "item_condition": {
            "type": "apoli:ingredient",
            "ingredient": {
              "item": "minecraft:dropper"
            }
          }
        }
      ]
    }
  },
  "fuku_no_kami_power_down": {
    "type": "apoli:modify_status_effect_duration",
    "status_effects": [
      "minecraft:slowness",
      "minecraft:mining_fatigue",
      "minecraft:instant_damage",
      "minecraft:nausea",
      "minecraft:blindness",
      "minecraft:hunger",
      "minecraft:weakness",
      "minecraft:poison",
      "minecraft:wither",
      "minecraft:glowing",
      "minecraft:levitation",
      "minecraft:unluck",
      "minecraft:bad_omen",
      "minecraft:darkness"
    ],
    "modifier": {
      "operation": "multiply_base_multiplicative",
      "value": -0.20
    },
    "condition": {
      "type": "apoli:and",
      "conditions": [
        {
          "type": "apoli:equipped_item",
          "equipment_slot": "head",
          "item_condition": {
            "type": "apoli:nbt",
            "nbt": "{tsukumogami_bound:1}"
          }
        },
        {
          "type": "apoli:equipped_item",
          "equipment_slot": "head",
          "item_condition": {
            "type": "apoli:ingredient",
            "ingredient": {
              "item": "minecraft:dropper"
            }
          }
        }
      ]
    }
  },
  "uba_power": {
    "type": "apoli:attacker_action_when_hit",
    "entity_action": {
      "type": "apoli:and",
      "actions": [
        {
          "type": "apoli:play_sound",
          "sound": "touhouorigins:entity.menreiki.thorns"
        },
        {
          "type": "apoli:choice",
          "actions": [
            {
              "element": {
                "type": "apoli:damage",
                "amount": 1,
                "source": {
                  "name": "thorns"
                }
              },
              "weight": 4
            },
            {
              "element": {
                "type": "apoli:damage",
                "amount": 2,
                "source": {
                  "name": "thorns"
                }
              },
              "weight": 2
            },
            {
              "element": {
                "type": "apoli:damage",
                "amount": 3,
                "source": {
                  "name": "thorns"
                }
              },
              "weight": 1
            },
            {
              "element": {
                "type": "apoli:damage",
                "amount": 4,
                "source": {
                  "name": "thorns"
                }
              },
              "weight": 1
            }
          ]
        }
      ]
    },
    "condition": {
      "type": "apoli:and",
      "conditions": [
        {
          "type": "apoli:equipped_item",
          "equipment_slot": "head",
          "item_condition": {
            "type": "apoli:nbt",
            "nbt": "{tsukumogami_bound:1}"
          }
        },
        {
          "type": "apoli:equipped_item",
          "equipment_slot": "head",
          "item_condition": {
            "type": "apoli:ingredient",
            "ingredient": {
              "item": "minecraft:dispenser"
            }
          }
        }
      ]
    }
  },
  "badges": [
    "origins:active"
  ]
}
